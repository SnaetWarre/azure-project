name: Azure ML Workflow

on:
  workflow_dispatch:
  push:
    branches:
      - main

env:
  GROUP: azure-ai
  WORKSPACE: snaet-warre-ai
  LOCATION: westeurope

jobs:
  azure-ml-test:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code repository
        uses: actions/checkout@v4
      
      - name: Azure Login
        uses: Azure/login@v2
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      
      - name: Azure test - Get Compute
        uses: Azure/CLI@v2.1.0
        with:
          azcliversion: 2.60.0
          inlineScript: |
            az extension add --name ml --allow-preview false || echo "ML extension already installed or failed"
            az configure --defaults group=$GROUP workspace=$WORKSPACE location=$LOCATION
            az ml compute list || echo "No compute resources found or command failed"

